// ===========================================
// Torrent List - Main torrent table styles
// ===========================================

@use "variables" as *;
@use "mixins" as *;

// Column widths via CSS custom properties (set on container via JS)
$torrent-columns: checkbox, name, order, size, remaining, done, status, seeds, peers,
  seeds_peers, downspd, upspd, eta, upped, downloaded, shared, added, completed, actions;

.torrent-list-layer {
  position: relative;
  overflow-x: auto;
  overflow-y: auto;
  flex-grow: 1;
  min-height: 20px;
  background: var(--card-bg);

  table {
    width: max-content;
  }

  @each $col in $torrent-columns {
    th.#{$col},
    td.#{$col} {
      min-width: var(--col-#{$col}-w);
      max-width: var(--col-#{$col}-w);
    }
  }
}

// Loading overlay
.torrent-list-loading {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(var(--bg-color-rgb, 255, 255, 255), 0.7);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;

  .dark & {
    background: rgba(0, 0, 0, 0.5);
  }
}

// Full screen mode - table fills width, scroll when needed
body:not(.popup) .torrent-list-layer table {
  min-width: 100%;

  // Keep checkbox fixed at 28px
  th.checkbox, td.checkbox {
    width: 28px !important;
    min-width: 28px !important;
    max-width: 28px !important;
  }

  // Keep actions fixed at 52px
  th.actions, td.actions {
    width: 52px !important;
    min-width: 52px !important;
    max-width: 52px !important;
  }
}

div.torrent-list-layer table {
  .name {
    text-align: left;

    div {
      overflow: hidden;
      position: relative;
      text-overflow: ellipsis;
    }
  }

  .size,
  .upped,
  .remaining,
  .downloaded {
    text-align: right;
  }

  .order,
  .eta,
  .seeds_peers,
  .shared {
    text-align: center;
  }

  .status div {
    @include text-ellipsis;
    text-align: center;

    .error_icon {
      width: 16px;
      height: 16px;
      display: inline-block;
      background-repeat: no-repeat;
      background-position: center center;
      background-size: 16px;
      background-image: url(../img/error_icon.svg);
      opacity: 1;
      vertical-align: middle;
    }
  }
}

div.torrent-list-layer tr:nth-child(even) {
  background-color: var(--bg-color);
}

table.torrent-table-head {
  position: fixed;
  z-index: 2;
  @include no-select;
}

table.torrent-table-body thead {
  visibility: hidden;
}

// Action buttons
div.torrent-list-layer table td.actions div.btns {
  a,
  button {
    width: 20px;
    height: 20px;
    cursor: pointer;
    display: inline-block;
    background-repeat: no-repeat;
    background-position: center center;
    background-size: 10px;
    background-color: transparent;
    border: none;
    padding: 0;
    opacity: 0.5;
    vertical-align: middle;
    border-radius: $radius-sm;
    transition: opacity $transition-base, background-color $transition-base;
    filter: var(--icon-filter);

    &:hover {
      opacity: 1;
      background-color: rgba($primary-color, 0.15);
    }
  }
}

div.torrent-list-layer table tr:hover td.actions div.btns > a,
div.torrent-list-layer table tr:hover td.actions div.btns > button,
div.torrent-list-layer table tr.selected td.actions div.btns > a,
div.torrent-list-layer table tr.selected td.actions div.btns > button {
  opacity: 0.8;
}

div.torrent-list-layer table tr.selected td.actions div.btns > a,
div.torrent-list-layer table tr.selected td.actions div.btns > button {
  filter: invert(100%);
}

div.torrent-list-layer table td.actions div.btns > .start {
  background-image: url('../img/play.svg');
}

div.torrent-list-layer table td.actions div.btns > .pause {
  background-image: url('../img/pause.svg');
}

div.torrent-list-layer table td.actions div.btns > .stop {
  background-image: url('../img/stop.svg');
}

// Sticky actions column (fixed to right edge)
div.torrent-list-layer table th.actions,
div.torrent-list-layer table td.actions {
  position: sticky;
  right: 0;
  z-index: 1;
  background-color: var(--card-bg);
}

div.torrent-list-layer table tr:nth-child(even) td.actions {
  background-color: var(--bg-color);
}

div.torrent-list-layer table tr.selected td.actions {
  background-color: var(--primary-color);
}
